# 屏幕截图测试页面实现计划

## 1. 平台通道设计
- 创建 `ScreenCaptureService` 类，使用 MethodChannel 与原生代码通信
- 定义方法：
  - `captureScreen()`：截取当前屏幕
  - `captureWindow(String windowName)`：Windows 平台截取指定窗口
  - `getRunningWindows()`：Windows 平台获取当前运行的窗口列表

## 2. 各平台截图实现
- **Windows**：
  - 使用 Win32 API 实现屏幕截图
  - 实现窗口枚举和指定窗口截图
  - 支持将截图转换为 RGBA 格式
- **Android**：
  - 使用 MediaProjection API 实现屏幕截图
  - 处理权限请求
  - 支持后台截图
- **iOS**：
  - 使用 UIGraphicsBeginImageContextWithOptions 实现截图
  - 处理权限请求

## 3. UI 布局设计
- 采用左右分栏布局，各占屏幕宽度的 50%
- 左侧：显示截取的屏幕图像
- 右侧：显示指定图片（可配置）
- 顶部：截图控制按钮
  - "截取当前屏幕" 按钮
  - 窗口选择下拉框（仅 Windows）
  - "截取指定窗口" 按钮（仅 Windows）

## 4. 状态管理
- 使用 StatefulWidget 管理截图状态
- 使用 Image.memory 显示截图结果
- 处理截图加载状态和错误情况

## 5. 项目结构
```
lib/
├── main.dart              # 主入口
├── services/
│   └── screen_capture_service.dart  # 截图服务
├── components/
│   └── ui/
│       └── screen_capture_test_page.dart  # 测试页面
├── models/
│   └── window_info.dart   # 窗口信息模型
└── utils/
    └── platform_utils.dart # 平台工具类
```

## 6. 实现步骤
1. 创建平台通道服务类
2. 实现各平台原生截图代码
3. 设计测试页面 UI
4. 实现截图逻辑和状态管理
5. 测试多平台截图功能

## 技术要点
- 平台特定代码隔离
- 异步截图处理，不阻塞 UI
- 图像格式转换（原生 → Flutter）
- Windows 窗口枚举和句柄获取
- 权限处理（Android/iOS）